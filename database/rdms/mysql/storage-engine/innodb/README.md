# InnoDB
- https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html


## 一、简介

是一个将表中数据存储到磁盘上的存储引擎，真正处理数据的过程发生在内存。

又由于内存和磁盘的读写速度相差很大，所有引入了页的概念。

将数据划分为若干个页，以页作为磁盘和内存之间交互的基本单位（PS：服务器在运行过程中不可更改页的大小）。

InnoDB 中页的大小一般为 16KB，也就是最少一次从磁盘中读取16KB的内容到内存中，或一次最少把内存中的16KB内容刷新到磁盘。

## 二、InnoDB Row Format 行格式

查看 test 库 test 表的行格式

show table status from test like 'test' \G;

⇒ Row_format: Dynamic

### 1. COMPACT行格式

**NULL值列表**

一条记录中的某些列可能存储NULL值，如果把这些NULL值都放到记录的真实数据中存储会很占空间，所以COMPACT行格式把一条记录中值为NULL的列统一管理起来，存储到NULL值列表中。

**InnoDB表主键生成策略**

优先使用用户自定义的主键作为主键 ；如果用户没有定义主键，则选取一个不允许存储NULL值的UNIQUE键作为主键；如果表中连不允许存储NULL值的UNIQUE键都没有定义，则InnoDB会为表默认添加一个名为row_id的隐藏列作为主键。

**溢出列**

若某个列存储的真实数据值的大小大于InnoDB默认页大小的值，那么在记录真实数据处只会存储该列的一部分数据，而把剩余的数据分散存储在几个其他的页中，然后在记录真实数据处用20字节存储指向这些页的地址，从而可以找到剩余数据所在的页（这些剩余数据所在的页称为溢出页）。

VARCHAR、TEXT、BLOB 等类型的列在存储数据多的时候可能会成为溢出列

MySQL中规定一个页中至少存放两行记录。

### 2. DYNAMIC行格式

MySQL5.7默认行格式，与COMPACT行格式类似，但在处理溢出列的数据时有些不一样；

COMPACT不会在记录的真实数据处存储该溢出列真实数据的一部分，而是把该列的所有真实数据都存到溢出列中，只在记录的真实数据处存储20字节大小指向溢出页的地址。

### 3. COMPRESSED行格式

与COMPACT行格式类型，不同点在于COMPRESSED会采用压缩算法对页面进行压缩，以节省空间。

### 4. REDUNDANT行格式

比较老的一种行格式
